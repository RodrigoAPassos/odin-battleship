(()=>{"use strict";const a=a=>{let e=0,t=!1;const i=a;return{isSunk:()=>(t=e==i,t),hit:()=>++e}},e=()=>{const e=(()=>{const e=[];for(let a=0;a<100;a++)e.push({hasShip:!1,shipName:null,wasShot:!1});return{grid:e,place:(t,i,s)=>{if("patrol"==s){const s=a(1);for(let a=0;a<1;a++)"h"==i?(e[t+a].hasShip=!0,e[t+a].shipName=s):(e[t+10*a].hasShip=!0,e[t+10*a].shipName=s)}else if("submarine"==s){const s=a(2);for(let a=0;a<2;a++)"h"==i?(e[t+a].hasShip=!0,e[t+a].shipName=s):(e[t+10*a].hasShip=!0,e[t+10*a].shipName=s)}else if("destroyer"==s){const s=a(3);for(let a=0;a<3;a++)"h"==i?(e[t+a].hasShip=!0,e[t+a].shipName=s):(e[t+10*a].hasShip=!0,e[t+10*a].shipName=s)}else if("battleship"==s){const s=a(4);for(let a=0;a<4;a++)"h"==i?(e[t+a].hasShip=!0,e[t+a].shipName=s):(e[t+10*a].hasShip=!0,e[t+10*a].shipName=s)}else if("carrier"==s){const s=a(5);for(let a=0;a<5;a++)"h"==i?(e[t+a].hasShip=!0,e[t+a].shipName=s):(e[t+10*a].hasShip=!0,e[t+10*a].shipName=s)}},receiveAttack:a=>1==e[a].hasShip?(e[a].wasShot=!0,e[a].shipName.hit(),"hit"):(e[a].wasShot=!0,"miss"),checkAllSunk:()=>e.filter((a=>null!=a.shipName)).every((a=>1==a.shipName.isSunk()))}})();let t,i=null,s=null,r=0;const h=(a,e)=>0==e.Gameboard.grid[a].wasShot?"hit"==e.Gameboard.receiveAttack(a)?"valid hit attack":"valid miss attack":"invalid attack",l=a=>{if(null==i){let e=Math.floor(100*Math.random());if(t=h(e,a),"valid hit attack"==t)i=e,s=e;else for(;"invalid attack"==t;)l(a)}else if(0==a.Gameboard.grid[i].shipName.isSunk()){let e;switch(r){case 0:e=i+1,e<100?t=h(e,a):r++,"valid hit attack"==t?i=e:"valid miss attack"==t?r++:(r++,l(a));break;case 1:e=s-1,e<100&&e>=0?t=h(e,a):r++,"valid hit attack"==t?s=e:"valid miss attack"==t?r++:(r++,l(a));break;case 2:e=i+10,e<100?t=h(e,a):r++,"valid hit attack"==t?i=e:"valid miss attack"==t?r++:(r++,l(a));break;case 3:e=s-10,e>=0&&(t=h(e,a)),"valid hit attack"==t&&(s=e)}}else i=null,s=null,r=0,l(a)};return{Gameboard:e,attackPlayer:h,computerAttack:l}},t=(a,e)=>{const i=document.querySelector(".player1 .shipsBoard"),s=document.querySelector(".player1 .attackBoard");for(;i.firstChild&&s.firstChild;)i.removeChild(i.firstChild),s.removeChild(s.firstChild);for(let e of a.Gameboard.grid){const t=document.createElement("div");t.classList.add("cell"),t.setAttribute("data-index",a.Gameboard.grid.indexOf(e)),1==e.hasShip&&t.classList.add("hasShip"),1==e.wasShot&&0==e.hasShip&&t.classList.add("waterHit"),1==e.wasShot&&1==e.hasShip&&t.classList.add("shipHit"),null!=e.shipName&&1==e.shipName.isSunk()&&t.classList.add("shipSunk"),i.appendChild(t)}for(let i of e.Gameboard.grid){const r=document.createElement("div");r.classList.add("cell"),r.setAttribute("data-index",e.Gameboard.grid.indexOf(i)),1==i.wasShot&&1==i.hasShip&&r.classList.add("shipHit"),1==i.wasShot&&0==i.hasShip&&r.classList.add("waterHit"),null!=i.shipName&&1==i.shipName.isSunk()&&r.classList.add("shipSunk"),0==i.wasShot&&r.addEventListener("click",(()=>{a.attackPlayer(r.getAttribute("data-index"),e),e.computerAttack(a),t(a,e)})),s.appendChild(r)}},i=t,s=()=>{document.querySelector(".newGameBtn").removeEventListener("click",s),document.querySelector(".newGameBtn").innerHTML="Restart",(()=>{const a=e(),t=e();a.Gameboard.place(4,"v","patrol"),a.Gameboard.place(0,"h","submarine"),a.Gameboard.place(31,"v","destroyer"),a.Gameboard.place(76,"h","battleship"),a.Gameboard.place(55,"h","carrier"),t.Gameboard.place(4,"v","patrol"),t.Gameboard.place(0,"v","submarine"),t.Gameboard.place(24,"h","destroyer"),t.Gameboard.place(74,"h","battleship"),t.Gameboard.place(54,"h","carrier"),i(a,t)})()};document.querySelector(".newGameBtn").addEventListener("click",s)})();