(()=>{"use strict";const e=e=>{let t=0,a=!1;const i=e;return{isSunk:()=>(a=t==i,a),hit:()=>++t}},t=()=>{const t=(()=>{const t=[];for(let e=0;e<100;e++)t.push({hasShip:!1,shipName:null,wasShot:!1});return{grid:t,place:(a,i,s)=>{if("patrol"==s){const s=e(1);for(let e=0;e<1;e++)"h"==i?(t[a+e].hasShip=!0,t[a+e].shipName=s):(t[a+10*e].hasShip=!0,t[a+10*e].shipName=s)}else if("submarine"==s){const s=e(2);for(let e=0;e<2;e++)"h"==i?(t[a+e].hasShip=!0,t[a+e].shipName=s):(t[a+10*e].hasShip=!0,t[a+10*e].shipName=s)}else if("destroyer"==s){const s=e(3);for(let e=0;e<3;e++)"h"==i?(t[a+e].hasShip=!0,t[a+e].shipName=s):(t[a+10*e].hasShip=!0,t[a+10*e].shipName=s)}else if("battleship"==s){const s=e(4);for(let e=0;e<4;e++)"h"==i?(t[a+e].hasShip=!0,t[a+e].shipName=s):(t[a+10*e].hasShip=!0,t[a+10*e].shipName=s)}else if("carrier"==s){const s=e(5);for(let e=0;e<5;e++)"h"==i?(t[a+e].hasShip=!0,t[a+e].shipName=s):(t[a+10*e].hasShip=!0,t[a+10*e].shipName=s)}},receiveAttack:e=>1==t[e].hasShip?(t[e].wasShot=!0,t[e].shipName.hit(),"hit"):(t[e].wasShot=!0,"miss"),checkAllSunk:()=>t.filter((e=>null!=e.shipName)).every((e=>1==e.shipName.isSunk()))}})();let a,i=null,s=null,r=0;const n=(e,t)=>0==t.Gameboard.grid[e].wasShot?"hit"==t.Gameboard.receiveAttack(e)?"valid hit attack":"valid miss attack":"invalid attack",l=e=>{if(null==i){let t=Math.floor(100*Math.random());if(a=n(t,e),"valid hit attack"==a)i=t,s=t;else for(;"invalid attack"==a;)l(e)}else if(0==e.Gameboard.grid[i].shipName.isSunk()){let t;switch(r){case 0:t=i+1,t<100?a=n(t,e):r++,"valid hit attack"==a?i=t:"valid miss attack"==a?r++:(r++,l(e));break;case 1:t=s-1,t<100&&t>=0?a=n(t,e):r++,"valid hit attack"==a?s=t:"valid miss attack"==a?r++:(r++,l(e));break;case 2:t=i+10,t<100?a=n(t,e):r++,"valid hit attack"==a?i=t:"valid miss attack"==a?r++:(r++,l(e));break;case 3:t=s-10,t>=0&&(a=n(t,e)),"valid hit attack"==a&&(s=t)}}else i=null,s=null,r=0,l(e)};return{Gameboard:t,attackPlayer:n,computerAttack:l}},a=e=>{e.dataTransfer.setData("text",e.target.id)},i=e=>{e.preventDefault();let t=e.dataTransfer.getData("text"),a=e.target.getAttribute("data-index");p1.Gameboard.place(a,"v",t),s(p1,p2,"pvcPlace")},s=(e,t,a)=>{const s=document.querySelector(".player1 .shipsBoard"),n=document.querySelector(".player1 .attackBoard");if(document.querySelector(".winner"),document.querySelector(".waiting"),"pvcPlace"===a){for(r();s.firstChild&&n.firstChild;)s.removeChild(s.firstChild),n.removeChild(n.firstChild);for(let t of e.Gameboard.grid){const a=document.createElement("div");a.classList.add("cell"),a.setAttribute("data-index",e.Gameboard.grid.indexOf(t)),a.addEventListener("drop",(()=>i(Event))),a.addEventListener("dragover",(()=>{Event.preventDefault()})),1==t.hasShip&&a.classList.add("hasShip"),1==t.wasShot&&0==t.hasShip&&a.classList.add("waterHit"),1==t.wasShot&&1==t.hasShip&&a.classList.add("shipHit"),null!=t.shipName&&1==t.shipName.isSunk()&&a.classList.add("shipSunk"),s.appendChild(a)}}},r=()=>{const e=document.querySelector(".winner"),t=document.querySelector(".waiting");e.innerHTML="Please place your Ships...";const i=document.createElement("ul");i.classList.add("shipList");const s=document.createElement("li");s.innerHTML="Patrol",s.setAttribute("id","patrol"),s.setAttribute("draggable","true"),s.addEventListener("dragstart",(()=>a(Event)));const r=document.createElement("li");r.innerHTML="Submarine",r.setAttribute("id","submarine"),r.setAttribute("draggable","true"),r.addEventListener("dragstart",(()=>a(Event)));const n=document.createElement("li");n.innerHTML="Destroyer",n.setAttribute("id","destroyer"),n.setAttribute("draggable","true"),n.addEventListener("dragstart",(()=>a(Event)));const l=document.createElement("li");l.innerHTML="Battleship",l.setAttribute("id","battleship"),l.setAttribute("draggable","true"),l.addEventListener("dragstart",(()=>a(Event)));const d=document.createElement("li");d.innerHTML="Carrier",d.setAttribute("id","carrier"),d.setAttribute("draggable","true"),d.addEventListener("dragstart",(()=>a(Event))),i.appendChild(s),i.appendChild(r),i.appendChild(n),i.appendChild(l),i.appendChild(d),t.appendChild(i)},n=s,l=e=>{document.querySelector(".newGameBtn").innerHTML="Restart",document.querySelector(".playVs").style.visibility="hidden",(e=>{const a=t(),i=t();n(a,i,"pvcPlace")})()};document.querySelector(".playVs").style.visibility="hidden",document.querySelector(".newGameBtn").addEventListener("click",(()=>{const e=document.querySelector(".playVs");"hidden"==e.style.visibility?e.style.visibility="visible":e.style.visibility="hidden"})),document.querySelector("button.PvC").addEventListener("click",(()=>l())),document.querySelector(".PvP").addEventListener("click",(()=>l()))})();